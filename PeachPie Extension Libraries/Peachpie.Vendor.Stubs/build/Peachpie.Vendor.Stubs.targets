<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

<!-- Определение свойств для упрощения настройки путей -->
<PropertyGroup>
    <NugetPackagePath>$(UserProfile)\.nuget\packages\**\1.0.2\**\*.php</NugetPackagePath>
    <VendorDirectory>$(ProjectDir)vendor</VendorDirectory>
    <StubsDirectory>$(VendorDirectory)\stubs</StubsDirectory>
</PropertyGroup>

<Target Name="PeachpieVendorStubs" BeforeTargets="Build">
    <ItemGroup>
        <NugetPhpFiles Include="$(NugetPackagePath)"/>
        <ExistingFiles Include="$(StubsDirectory)"/>
    </ItemGroup>

    <!-- Удаляем старый каталог vendor -->
    <RemoveDir Directories="@(ExistingFiles)" />

    <!-- Копируем новые PHP-файлы в каталог Stubs -->
    <Copy SourceFiles="@(NugetPhpFiles)"
          DestinationFolder="$(StubsDirectory)\%(RecursiveDir)" />
</Target>

<!--
    <UsingTask TaskName="PeachpieVendorStubs.PackageListInfo" AssemblyFile="$(MSBuildThisFileDirectory)..\lib\netstandard2.0\Peachpie.Vendor.Stubs.dll" />
    <Target Name="StubsUnpuck" AfterTargets="Build">
        <Peachpie.Vendor.Stubs.PackageListInfo />
    </Target>
    -->

</Project>

